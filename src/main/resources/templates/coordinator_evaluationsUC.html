<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluations - UC Management</title>
    <link rel="stylesheet" type="text/css" href="/css/coordinator_evaluationsUC.css">
</head>

<body>
    <header>
        <h1>Evaluations for UC</h1>
        <nav>
            <button onclick="window.location.href='/coordinator'">Back</button>
            <button
                th:onclick="'window.location.href=\'/coordinator/coordinator_create_evaluation?curricularUnitId=' + ${uc.id} + '\''">Create
                Evaluation</button>
            <button onclick="window.location.href='/logout'">Logout</button>
        </nav>
    </header>

    <main>
        <section class="section">
            <h2>Evaluations List</h2>

            <!-- Check if evaluations is not null and not empty -->
            <div th:if="${evaluations != null && evaluations.size() > 0}">
                <table>
                    <thead>
                        <tr>
                            <th>Evaluation Type</th>
                            <th>Weight</th>
                            <th>Exam Period</th>
                            <th>Class Time</th>
                            <th>Room</th>
                            <th>Minimum Grade</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Loop through the list of evaluations -->
                        <tr th:each="evaluation : ${evaluations}">
                            <td th:text="${evaluation.type}">Evaluation Type</td>
                            <td th:text="${evaluation.weight}">0</td>
                            <td th:text="${evaluation.examPeriod}">None</td>
                            <td th:text="${evaluation.classTime}">N/A</td>
                            <td th:text="${evaluation.room}">Room 101</td>
                            <td th:text="${evaluation.minimumGrade}">0.0</td>
                            <td>
                                <!-- Edit Button -->
                                <form th:action="@{/coordinator/coordinator_editEvaluations/{id}(id=${evaluation.id})}" method="GET" style="display:inline;">
                                    <input type="hidden" name="curricularUnitId" th:value="${uc.id}" />
                                    <button type="submit">Edit</button>
                                </form>
                                
                                <form th:action="@{/coordinator/coordinator_delete_evaluation/{id}(id=${evaluation.id})}" method="POST" style="display:inline;">
                                    <input type="hidden" name="curricularUnitId" th:value="${uc.id}" />
                                    <button type="submit">Remove</button>
                                </form>
                                
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p th:classappend="${uc.evaluationsCount == evaluations.size()} ? 'valid' : 'invalid'">
                    <span th:text="'Evaluations: ' + ${evaluations.size()} + ' / ' + ${uc.evaluationsCount}"></span>
                </p>
            </div>

            <!-- Message when no evaluations are found -->
            <p th:if="${evaluations == null || evaluations.size() == 0}">
                No evaluations found for this UC. Please create a new evaluation.
            </p>
            
            <!-- Message for Mixed evaluation type without Exam Period evaluation -->
            <p th:if="${uc.evaluationType == 'Mixed' && !uc.hasExamPeriodEvaluation()}" style="color: red;">
                For Mixed evaluation type, at least one evaluation must be of type 'Exam Period'.
            </p>
            
            <!-- Message if the total weight of all evaluations does not reach 100% -->
            <p th:if="${uc.isTotalWeightLessThan100()}" style="color: red;">
                The total weight of all evaluations must reach 100%.
            </p>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 University - Academic Administration System</p>
    </footer>

</body>

</html>
